{% extends "users/layout.html" %}
{% load static %}
{% block header %}
  <header style="background-color: black; position: relative;">
    <img src="{% static 'images/mac_header.jpg' %}" style="width: 8%; position: absolute; top: 25px; left: 75px;" alt="Mac" />
    <h1 style="color: yellow;">Mac's Strength and Power: Fitness Tracker</h1>
    <nav>
      <span>
        <div class="container" style="display: flex; justify-content: space-around;">
          <div class="row">
            <div class="col">
              <a href="{% url 'users-profile' %}" style="color: yellow; background-color: black; border-color: white;" onmouseover="this.style.borderColor='yellow'" onmouseout="this.style.borderColor='white'">Home</a>
            </div>
            <div class="col">
              <div class="dropdown">
                <button class="btn btn-outline-warning dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="color: yellow; background-color: black; border-color: white;" onmouseover="this.style.borderColor='yellow'" onmouseout="this.style.borderColor='white'">
                    Diary, Goals and Metrics
                </button>
                <ul class="dropdown-menu" style="background-color: black; overflow: hidden; padding-right: 15px; text-align: center; border: 1px solid gray;">
                    <li class="d-grid"><a class="dropdown-item" href="{% url 'users-diary' %}" style="color: white; background-color: black !important; padding: 0">Diary</a></li>
                    <li class="d-grid"><a class="dropdown-item" href="{% url 'users-goal' %}" style="color: white; background-color: black !important; padding: 0">Goals</a></li>
                    <li class="d-grid"><a class="dropdown-item" href="{% url 'metrics' %}" style="color: white; background-color: black !important; padding: 0;">Metrics</a></li>
                </ul>
              </div>
            </div>
            <div class="col text-start">
              <a href="{% url 'about_page' %}" style="color: yellow; background-color: black; border-color: white;" onmouseover="this.style.borderColor='yellow'" onmouseout="this.style.borderColor='white'">About</a>
            </div>
          </div>
        </div>
      </span>
    </nav>
  </header>
{% endblock %}

{% block main %}
<body style="background-color: black;">
  <div class="row">
    <h2 style="color: white;">Your Workouts by Month</h2>
    <div class="col-md-6">
      <br>
      <select id="month-filter" class="form-select" onchange="filterWorkouts(this.value)">
        <option value="" selected disabled>Select Month</option>
        <option value="1">January</option>
        <option value="2">February</option>
        <option value="3">March</option>
        <option value="4">April</option>
        <option value="5">May</option>
        <option value="6">June</option>
        <option value="7">July</option>
        <option value="8">August</option>
        <option value="9">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
        <option value="">All Months</option>
      </select>      
    </div>
    <div class="col-md-6 text-end">
      <a href="{% url 'create_workout' %}">
        <button type="button" id="add-exercise" class="rounded-button" style="color: yellow; background-color: black; border-color: white;">Create New Workout</button>
      </a>
    </div>
  </div>
  <br>
  <ul>
    {% for workout in workouts %}
    <li class="workout-item" data-month="{{ workout.day.month }}">
      <strong style="color: yellow;">{{ workout.name }} - <small style="color: lightgray; font-weight: normal; font-size: 80%;">{{ workout.day }} AKT</small></strong>
      <p style="color: white; margin-top: 10px;"><span style="color: gray; font-style: italic;">Notes:</span> {{ workout.description }}</p>
      {% for obj in workout.workoutexercise_set.all %}
      <p>
        <span style="color: white;"><span style="font-style: italic;">Exercise</span> {{ forloop.counter }} - {{ obj.exercise.name }}:</span>
        <span style="color: white;">{{ obj.sets }} {% if obj.sets == 1 %} set{% else %} sets{% endif %}, {{ obj.reps }} {% if obj.reps == 1 %} rep{% else %} reps{% endif %}</span>
      </p>
      {% endfor %}
      <form method="post" action="{% url 'delete_workout' workout.id %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger btn-rounded" style="margin-bottom: 20px;">Delete</button>
      </form>
    </li>
    {% endfor %}
  </ul>
</body>
<style>
  .rounded-button {
    border-radius: 8px;
  }

  .workout-item {
    display: none;  /* Hide all workout items by default */
  }
</style>

<script>
  function filterWorkouts(selectedMonth) {
    var workouts = document.getElementsByClassName('workout-item');

    for (var i = 0; i < workouts.length; i++) {
      var workoutMonth = workouts[i].getAttribute('data-month');

      if (selectedMonth === "" || (selectedMonth !== "" && workoutMonth === selectedMonth)) {
        workouts[i].style.display = 'block';
      } else {
        workouts[i].style.display = 'none';
      }
    }
  }
</script>

{% endblock %}